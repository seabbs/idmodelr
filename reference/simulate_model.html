<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>A Function to Simulate a Model from a Generic Simulation Function, with Pre and Post Processing — simulate_model • idmodelr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="A Function to Simulate a Model from a Generic Simulation Function, with Pre and Post Processing — simulate_model"><meta property="og:description" content="A Function to Simulate a Model from a Generic Simulation Function, with Pre and Post Processing"><meta property="og:image" content="samabbott.co.uk/idmodelr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">idmodelr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/resources.html">Other resources</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Models &amp; parameters
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/model_details.html">Model details</a>
    </li>
    <li>
      <a href="../articles/parameter_details.html">Parameter details</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://www.samabbott.co.uk/tags/idmodelr/" class="external-link">Blog posts</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/seabbs/idmodelr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A Function to Simulate a Model from a Generic Simulation Function, with Pre and Post Processing</h1>
    <small class="dont-index">Source: <a href="https://github.com/seabbs/idmodelr/blob/HEAD/R/simulate_model.R" class="external-link"><code>R/simulate_model.R</code></a></small>
    <div class="hidden name"><code>simulate_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A Function to Simulate a Model from a Generic Simulation Function, with Pre and Post Processing</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulate_model</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">sim_fn</span>,</span>
<span>  inits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  times <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  as_tibble <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  by_row <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  aggregate_to <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  compartments <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hold_out_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  new_var <span class="op">=</span> <span class="st">"incidence"</span>,</span>
<span>  total_pop <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  summary_var <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>A model compatible with your <code>sim_fn</code>.</p></dd>


<dt>sim_fn</dt>
<dd><p>A generic simulation function, with the first argument as the model object,
a <code>params</code> argument, and a <code>as.data.frame</code> argument.</p></dd>


<dt>inits</dt>
<dd><p>A dataframe of initial conditions, optionally a named vector can be used.</p></dd>


<dt>params</dt>
<dd><p>A dataframe of parameters, with each parameter as a variable. Optionally a named vector can be used.</p></dd>


<dt>times</dt>
<dd><p>A vector of the times to sample the model for, from a starting time to a final time.</p></dd>


<dt>as_tibble</dt>
<dd><p>Logical (defaults to <code>TRUE</code>) indicating if the output
should be returned as a tibble, otherwise returned as the default <code>sim_fn</code> output.</p></dd>


<dt>by_row</dt>
<dd><p>Logical (defaults to <code>FALSE</code>) indicating if inputted parameters should be inputted as a block to <code>sim_fn</code>
or individually. If <code>TRUE</code> then function will always return a tibble. Does not currently work with sim_fn that produces
multiple simulations for a single parameter set - for this scenario a block based approach or post processing is required.</p></dd>


<dt>aggregate_to</dt>
<dd><p>A character vector or list specifying the aggregation operations to perform on the
model output. Operations are carried out in the order specified. Implemented options are; disease, demographic,
and incidence.</p></dd>


<dt>compartments</dt>
<dd><p>A character vector or list specifying the unique compartments to aggregate. May either be
specified once for all aggregation functions or for each function separately.</p></dd>


<dt>strat</dt>
<dd><p>The number of stratified groups in the model.</p></dd>


<dt>hold_out_var</dt>
<dd><p>A character vector or list specifying the unique compartments that will not be aggregated. May either be
specified once for all aggregation functions or for each function separately. If compartments is set then this argument does
not need to be used.</p></dd>


<dt>new_var</dt>
<dd><p>A character vector specifying the new variable to add when aggregating incidence.</p></dd>


<dt>total_pop</dt>
<dd><p>A logical (defaults to <code>TRUE</code>) indicating if the total population should be
calculated when summarising the model demographics.</p></dd>


<dt>summary_var</dt>
<dd><p>A logical (defaults to <code>FALSE</code>), specifying whether to add an additional summary variable across
all stratified levels.</p></dd>


<dt>verbose</dt>
<dd><p>Logical (defaults to <code>FALSE</code>) indicating if progress information should be printed to the console.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to pass to <code>sim_fn</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Trajectories as a tibble, optionally returns the default <code>sim_fn</code> output.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>aggregate_model</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Intialise</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">100000</span></span></span>
<span class="r-in"><span><span class="va">I_0</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">S_0</span> <span class="op">=</span> <span class="va">N</span> <span class="op">-</span> <span class="va">I_0</span></span></span>
<span class="r-in"><span><span class="va">R_0</span> <span class="op">=</span> <span class="fl">1.1</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">=</span> <span class="va">R_0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Time for model to run over</span></span></span>
<span class="r-in"><span><span class="va">tbegin</span> <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">tend</span> <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">tbegin</span>, <span class="va">tend</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Vectorise input</span></span></span>
<span class="r-in"><span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="va">beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>S <span class="op">=</span> <span class="va">S_0</span>, I <span class="op">=</span> <span class="va">I_0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SI_sim</span> <span class="op">&lt;-</span> <span class="fu">simulate_model</span><span class="op">(</span>model <span class="op">=</span> <span class="va">SI_ode</span>, sim_fn <span class="op">=</span> <span class="va">solve_ode</span>, <span class="va">inits</span>, <span class="va">parameters</span>, <span class="va">times</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sam Abbott, Akira Endo.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ec77738e3c0c9f4b2529464269a70757',
    indexName: 'samabbott-idmodelr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

